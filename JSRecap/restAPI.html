<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="./functions/api_key.js"></script>
    <title>REST API</title>
</head>
<body>
    <script>
        //1. Get(yesterday recap)
        // fetch("https://api.github.com/users/zellwk/repos")
        //     .then((response) => {return response.json()})
        //     .then((result) => {console.log(result)})
        //     .catch(err => console.log(err));

        // fetch("https://jsonplaceholder.typicode.com/posts")
        //     .then((response) => {return response.json()})
        //     .then((result) => {console.log(result)})
        //     .catch(err => console.log(err));

        //2.POST
        // fetch("https://jsonplaceholder.typicode.com/posts", {
        //     method: "POST",
        //     body: JSON.stringify({
        //         title: "post test",
        //         body: "post test",
        //         userId: 6
        //     }),
        //     headers: {
        //         "Content-type": "application/json; charset=UTF-8"
        //     }
        // }).then(response => response.json())
        // .then(result => console.log(result));

        //3.PUT(edit)
        // fetch("https://jsonplaceholder.typicode.com/posts/8", {
        //     method: "PUT",
        //     body: JSON.stringify({
        //         title: "change title test",
        //         id: 1,
        //         userId: 40
        //     }),
        //     headers: {
        //         "Content-type": "application/json; charset=UTF-8"
        //     }
        // }).then(response => response.json())
        // .then(result => console.log(result));

        //Request constructor
        // const request = new Request("https://www.yahoo.co.jp", {method: "GET"});
        // const URL = request.url;
        // const method = request.method;
        // const credentials = request.credentials;
        // const bodyUsed = request.bodyUsed;
        // console.log(URL);
        // console.log(method);
        // console.log(credentials);
        // console.log(bodyUsed);
        // console.log(request);
        
        //Header
        // var authorName = "Shin Daimon";
        // var myHeader = new Headers();
        // myHeader.append("Author", authorName);
        
        //URLParamSearch
        // let url = new URL(window.location);
        // console.log(url);
        // console.log(url.href);
        // console.log(url.pathname);
        // console.log(url.searchParams.toString());
        //     //get query strings
        //     let params = new URLSearchParams(window.location.search);
        //     console.log(params.toString());
        //     //change a path
        //     url.pathname = "wavescoffee.html";
        //     console.log(url.pathname);
        
        //Change object into query string
        // const object = {name: "Shin", age: 32};
        // console.log(object);
        // const queryString = Object.keys(object).map(key => key + "=" + object[key]).join("&");
        // console.log(queryString);

        //Weather API
        // const endpoint = "https://cors-anywhere.herokuapp.com/https://api.yelp.com/v3/businesses/north-india-restaurant-san-francisco";
        // fetch(endpoint, {
        //     // method: "GET",
        //     headers: {
        //         "Authorization": "Bearer " + api_key.YELP
        //     }
        // }).then(response => response.json())
        // .then(result => console.log(result))
        // .catch(error => console.log(error));

        //Weather API
        // endpoint = "https://cors-anywhere.herokuapp.com/http://api.openweathermap.org/data/2.5/weather?q=Vancouver";
        // fetch(endpoint, {
        //     // method: "GET",
        //     headers: {
        //         "X-API-Key": api_key.Weather
        //     }
        // }).then(response => response.json())
        // .then(result => console.log(result))
        // .catch(error => console.log(error));

        //SuperHero API
        const endpoint = "https://cors-anywhere.herokuapp.com/https://superheroapi.com/api/" + api_key.SuperHero;

        function clickHero() {
            const heroName = document.getElementById("heroName").value;
            console.log(heroName);
            fetch(endpoint + "/search/" + heroName, {
            // method: "GET",
            }).then(response => response.json())
            .then(result => showCharacter(result))
            .catch(error => console.log(error));
        }
        function showCharacter(result) {
            console.log(result);
            const heroData = document.getElementById("heroData");
            const list = result.results.map((result) => {
                const listHtml = `<div>${result.name}<img src="${result.image.url}" /></div>`
                heroData.insertAdjacentHTML("beforeend", listHtml);
            });
        }
        
    </script>
    <input id="heroName" type="text" placeholder="Hero Name"/>
    <button onclick="clickHero()">Search</button>
    <div id="heroData">
        
    </div>
</body>
</html>